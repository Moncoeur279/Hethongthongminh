{"ast":null,"code":"var _jsxFileName = \"F:\\\\english-chat\\\\Frontend\\\\src\\\\components\\\\ChatMain.js\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { useParams } from \"react-router-dom\";\nimport \"../styles/ChatMessage.css\";\nimport \"../styles/ChatInput.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ChatMain() {\n  _s();\n  const {\n    id: conversationId\n  } = useParams();\n  const [text, setText] = useState(\"\");\n  const [isTyping, setIsTyping] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [popover, setPopover] = useState(null);\n  const listRef = useRef(null);\n  const token = localStorage.getItem(\"accessToken\");\n\n  // Tá»± Ä‘á»™ng cuá»™n xuá»‘ng cuá»‘i khi cÃ³ tin nháº¯n má»›i\n  useEffect(() => {\n    var _listRef$current;\n    (_listRef$current = listRef.current) === null || _listRef$current === void 0 ? void 0 : _listRef$current.scrollTo({\n      top: listRef.current.scrollHeight,\n      behavior: \"smooth\"\n    });\n  }, [messages, conversationId]);\n  useEffect(() => {\n    const clearOnDelete = () => setMessages([]); // clear UI\n    window.addEventListener(\"conversation-deleted\", clearOnDelete);\n    return () => window.removeEventListener(\"conversation-deleted\", clearOnDelete);\n  }, []);\n  useEffect(() => {\n    if (!conversationId || !token) return;\n    axios.get(`http://localhost:3030/api/chat/messages/${conversationId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(res => setMessages(res.data.map(m => ({\n      id: m.id,\n      text: m.content,\n      isUser: m.role === \"user\",\n      timestamp: new Date(m.createdAt).toLocaleTimeString([], {\n        hour: \"2-digit\",\n        minute: \"2-digit\"\n      }),\n      corrections: []\n    })))).catch(err => console.error(\"Load messages error:\", err));\n  }, [conversationId, token]);\n  const handleSend = async e => {\n    e.preventDefault();\n    const userText = text.trim();\n    if (!userText) return;\n    const now = new Date().toLocaleTimeString([], {\n      hour: \"2-digit\",\n      minute: \"2-digit\"\n    });\n    const tempId = Date.now();\n\n    // ThÃªm user message\n    const newUserMsg = {\n      id: tempId,\n      text: userText,\n      isUser: true,\n      timestamp: now,\n      corrections: []\n    };\n    setMessages(prev => [...prev, newUserMsg]);\n    setText(\"\");\n    setIsTyping(true);\n    try {\n      const [chatRes, grammarRes] = await Promise.all([fetch(\"http://localhost:3030/api/chat\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          conversationId,\n          text: userText\n        })\n      }), fetch(\"http://localhost:3030/api/grammar\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          text: userText\n        })\n      })]);\n      const chatData = await chatRes.json();\n      const grammarData = await grammarRes.json();\n\n      // Gáº¯n lá»—i ngá»¯ phÃ¡p vÃ o message user\n      setMessages(prev => prev.map(m => {\n        var _grammarData$correcti;\n        return m.id === tempId ? {\n          ...m,\n          corrections: ((_grammarData$correcti = grammarData.corrections) === null || _grammarData$correcti === void 0 ? void 0 : _grammarData$correcti.map((c, i) => ({\n            id: i + 1,\n            original: c.original,\n            suggestion: c.suggestion,\n            reason: c.reason,\n            label: c.label,\n            applied: false\n          }))) || []\n        } : m;\n      }));\n\n      // Pháº£n há»“i cá»§a AI\n      if (chatData.botMsg) {\n        setMessages(prev => [...prev, {\n          id: chatData.botMsg.id,\n          text: chatData.botMsg.content,\n          isUser: false,\n          timestamp: new Date(chatData.botMsg.createdAt).toLocaleTimeString([], {\n            hour: \"2-digit\",\n            minute: \"2-digit\"\n          })\n        }]);\n      } else if (chatData.reply) {\n        // fallback khi chá»‰ cÃ³ reply\n        setMessages(prev => [...prev, {\n          id: tempId + 1,\n          text: chatData.reply,\n          isUser: false,\n          timestamp: now\n        }]);\n      }\n    } catch (err) {\n      console.error(\"Error contacting API:\", err);\n      setMessages(prev => [...prev, {\n        id: tempId + 1,\n        text: \"Demo pháº£n há»“i cá»§a AI\",\n        isUser: false,\n        timestamp: new Date().toLocaleTimeString([], {\n          hour: \"2-digit\",\n          minute: \"2-digit\"\n        })\n      }]);\n    } finally {\n      setIsTyping(false);\n      window.dispatchEvent(new Event(\"conversation-updated\"));\n    }\n  };\n  const applyCorrection = (msgId, corr) => {\n    setMessages(prev => prev.map(m => {\n      if (m.id !== msgId) return m;\n      const regex = new RegExp(`\\\\b${escapeRegex(corr.original)}\\\\b`, \"i\");\n      const newText = m.text.replace(regex, corr.suggestion);\n      const updatedCorrections = m.corrections.map(c => c.id === corr.id ? {\n        ...c,\n        applied: true\n      } : c);\n      return {\n        ...m,\n        text: newText,\n        corrections: updatedCorrections\n      };\n    }));\n    setPopover(null);\n  };\n  const handleWordClick = (e, msgId, corr) => {\n    const rect = e.target.getBoundingClientRect();\n    const popoverWidth = 260;\n    const popoverHeight = 140;\n    let x = rect.left;\n    let y = rect.bottom + window.scrollY;\n    if (x + popoverWidth > window.innerWidth - 20) x = window.innerWidth - popoverWidth - 20;\n    if (y + popoverHeight > window.innerHeight + window.scrollY) y = rect.top + window.scrollY - popoverHeight - 10;\n    setPopover({\n      x,\n      y,\n      corr,\n      msgId\n    });\n  };\n  const hasConversation = !!conversationId;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-main\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: listRef,\n      className: \"messages-list\",\n      children: [messages.map(m => {\n        var _m$corrections;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `message ${m.isUser ? \"user-message\" : \"ai-message\"}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-avatar\",\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              children: m.isUser ? \"U\" : \"AI\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 45\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-bubble\",\n              children: m.isUser && ((_m$corrections = m.corrections) === null || _m$corrections === void 0 ? void 0 : _m$corrections.length) > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"highlighted-text\",\n                children: renderTextWithHighlights(m, handleWordClick)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                children: m.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-timestamp\",\n              children: m.timestamp\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 13\n          }, this)]\n        }, m.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 11\n        }, this);\n      }), isTyping && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"message ai-message\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message-avatar\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"AI\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 45\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message-content\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-bubble\",\n            children: \"Typing\\u2026\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 7\n    }, this), popover && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grammar-popover\",\n      style: {\n        top: popover.y,\n        left: popover.x\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"popover-header\",\n        children: popover.corr.label\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"popover-body\",\n        children: popover.corr.reason\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"popover-suggest\",\n        children: [\"\\uD83D\\uDC49 \", /*#__PURE__*/_jsxDEV(\"b\", {\n          children: popover.corr.suggestion\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 16\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => applyCorrection(popover.msgId, popover.corr),\n        children: \"Apply\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setPopover(null),\n        children: \"Close\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"chat-input-form\",\n      onSubmit: handleSend,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"message-input\",\n          type: \"text\",\n          placeholder: hasConversation ? \"Type your message...\" : \"Please select or start a new conversation\",\n          value: text,\n          onChange: e => setText(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"send-btn\",\n          type: \"submit\",\n          disabled: !text.trim(),\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            width: \"16\",\n            height: \"16\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            strokeWidth: \"2\",\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            children: [/*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"m22 2-7 20-4-9-9-4Z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M22 2 11 13\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 196,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatMain, \"8CS6SfixFCfwm9M4ynk1Kc9j498=\", false, function () {\n  return [useParams];\n});\n_c = ChatMain;\nfunction renderTextWithHighlights(msg, onClick) {\n  let text = msg.text;\n  msg.corrections.forEach(corr => {\n    const regex = new RegExp(`(${escapeRegex(corr.original)})`, \"gi\");\n    text = text.replace(regex, `<span class=\"${corr.applied ? \"word-fixed\" : \"word-error\"}\" data-id=\"${corr.id}\">$1</span>`);\n  });\n  return /*#__PURE__*/_jsxDEV(\"span\", {\n    dangerouslySetInnerHTML: {\n      __html: text\n    },\n    onClick: e => {\n      const span = e.target.closest(\"span[data-id]\");\n      if (!span) return;\n      const id = parseInt(span.getAttribute(\"data-id\"));\n      const corr = msg.corrections.find(c => c.id === id);\n      if (corr) onClick(e, msg.id, corr);\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 285,\n    columnNumber: 5\n  }, this);\n}\nfunction escapeRegex(str) {\n  return str.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\nvar _c;\n$RefreshReg$(_c, \"ChatMain\");","map":{"version":3,"names":["useState","useRef","useEffect","axios","useParams","jsxDEV","_jsxDEV","ChatMain","_s","id","conversationId","text","setText","isTyping","setIsTyping","messages","setMessages","popover","setPopover","listRef","token","localStorage","getItem","_listRef$current","current","scrollTo","top","scrollHeight","behavior","clearOnDelete","window","addEventListener","removeEventListener","get","headers","Authorization","then","res","data","map","m","content","isUser","role","timestamp","Date","createdAt","toLocaleTimeString","hour","minute","corrections","catch","err","console","error","handleSend","e","preventDefault","userText","trim","now","tempId","newUserMsg","prev","chatRes","grammarRes","Promise","all","fetch","method","body","JSON","stringify","chatData","json","grammarData","_grammarData$correcti","c","i","original","suggestion","reason","label","applied","botMsg","reply","dispatchEvent","Event","applyCorrection","msgId","corr","regex","RegExp","escapeRegex","newText","replace","updatedCorrections","handleWordClick","rect","target","getBoundingClientRect","popoverWidth","popoverHeight","x","left","y","bottom","scrollY","innerWidth","innerHeight","hasConversation","className","children","ref","_m$corrections","fileName","_jsxFileName","lineNumber","columnNumber","length","renderTextWithHighlights","style","onClick","onSubmit","type","placeholder","value","onChange","disabled","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","_c","msg","forEach","dangerouslySetInnerHTML","__html","span","closest","parseInt","getAttribute","find","str","$RefreshReg$"],"sources":["F:/english-chat/Frontend/src/components/ChatMain.js"],"sourcesContent":["import { useState, useRef, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { useParams } from \"react-router-dom\";\nimport \"../styles/ChatMessage.css\";\nimport \"../styles/ChatInput.css\";\n\nexport default function ChatMain() {\n  const { id: conversationId } = useParams();\n  const [text, setText] = useState(\"\");\n  const [isTyping, setIsTyping] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [popover, setPopover] = useState(null);\n  const listRef = useRef(null);\n  const token = localStorage.getItem(\"accessToken\");\n\n  // Tá»± Ä‘á»™ng cuá»™n xuá»‘ng cuá»‘i khi cÃ³ tin nháº¯n má»›i\n  useEffect(() => {\n    listRef.current?.scrollTo({\n      top: listRef.current.scrollHeight,\n      behavior: \"smooth\",\n    });\n  }, [messages, conversationId]);\n\n  useEffect(() => {\n    const clearOnDelete = () => setMessages([]); // clear UI\n    window.addEventListener(\"conversation-deleted\", clearOnDelete);\n    return () => window.removeEventListener(\"conversation-deleted\", clearOnDelete);\n  }, []);\n\n  useEffect(() => {\n    if (!conversationId || !token) return;\n\n    axios\n      .get(`http://localhost:3030/api/chat/messages/${conversationId}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      })\n      .then((res) =>\n        setMessages(\n          res.data.map((m) => ({\n            id: m.id,\n            text: m.content,\n            isUser: m.role === \"user\",\n            timestamp: new Date(m.createdAt).toLocaleTimeString([], {\n              hour: \"2-digit\",\n              minute: \"2-digit\",\n            }),\n            corrections: [],\n          }))\n        )\n      )\n      .catch((err) => console.error(\"Load messages error:\", err));\n  }, [conversationId, token]);\n\n  const handleSend = async (e) => {\n    e.preventDefault();\n    const userText = text.trim();\n    if (!userText) return;\n\n    const now = new Date().toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" });\n    const tempId = Date.now();\n\n    // ThÃªm user message\n    const newUserMsg = {\n      id: tempId,\n      text: userText,\n      isUser: true,\n      timestamp: now,\n      corrections: [],\n    };\n    setMessages((prev) => [...prev, newUserMsg]);\n    setText(\"\");\n    setIsTyping(true);\n\n    try {\n      const [chatRes, grammarRes] = await Promise.all([\n        fetch(\"http://localhost:3030/api/chat\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${token}`,\n          },\n          body: JSON.stringify({ conversationId, text: userText }),\n        }),\n        fetch(\"http://localhost:3030/api/grammar\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ text: userText }),\n        }),\n      ]);\n\n      const chatData = await chatRes.json();\n      const grammarData = await grammarRes.json();\n\n      // Gáº¯n lá»—i ngá»¯ phÃ¡p vÃ o message user\n      setMessages((prev) =>\n        prev.map((m) =>\n          m.id === tempId\n            ? {\n              ...m,\n              corrections:\n                grammarData.corrections?.map((c, i) => ({\n                  id: i + 1,\n                  original: c.original,\n                  suggestion: c.suggestion,\n                  reason: c.reason,\n                  label: c.label,\n                  applied: false,\n                })) || [],\n            }\n            : m\n        )\n      );\n\n      // Pháº£n há»“i cá»§a AI\n      if (chatData.botMsg) {\n        setMessages((prev) => [\n          ...prev,\n          {\n            id: chatData.botMsg.id,\n            text: chatData.botMsg.content,\n            isUser: false,\n            timestamp: new Date(chatData.botMsg.createdAt).toLocaleTimeString([], {\n              hour: \"2-digit\",\n              minute: \"2-digit\",\n            }),\n          },\n        ]);\n      } else if (chatData.reply) {\n        // fallback khi chá»‰ cÃ³ reply\n        setMessages((prev) => [\n          ...prev,\n          {\n            id: tempId + 1,\n            text: chatData.reply,\n            isUser: false,\n            timestamp: now,\n          },\n        ]);\n      }\n    } catch (err) {\n      console.error(\"Error contacting API:\", err);\n      setMessages((prev) => [\n        ...prev,\n        {\n          id: tempId + 1,\n          text: \"Demo pháº£n há»“i cá»§a AI\",\n          isUser: false,\n          timestamp: new Date().toLocaleTimeString([], {\n            hour: \"2-digit\",\n            minute: \"2-digit\",\n          }),\n        },\n      ]);\n    } finally {\n      setIsTyping(false);\n      window.dispatchEvent(new Event(\"conversation-updated\"));\n    }\n  };\n\n  const applyCorrection = (msgId, corr) => {\n    setMessages((prev) =>\n      prev.map((m) => {\n        if (m.id !== msgId) return m;\n\n        const regex = new RegExp(`\\\\b${escapeRegex(corr.original)}\\\\b`, \"i\");\n        const newText = m.text.replace(regex, corr.suggestion);\n\n        const updatedCorrections = m.corrections.map((c) =>\n          c.id === corr.id ? { ...c, applied: true } : c\n        );\n\n        return { ...m, text: newText, corrections: updatedCorrections };\n      })\n    );\n    setPopover(null);\n  };\n\n  const handleWordClick = (e, msgId, corr) => {\n    const rect = e.target.getBoundingClientRect();\n    const popoverWidth = 260;\n    const popoverHeight = 140;\n    let x = rect.left;\n    let y = rect.bottom + window.scrollY;\n\n    if (x + popoverWidth > window.innerWidth - 20)\n      x = window.innerWidth - popoverWidth - 20;\n    if (y + popoverHeight > window.innerHeight + window.scrollY)\n      y = rect.top + window.scrollY - popoverHeight - 10;\n\n    setPopover({ x, y, corr, msgId });\n  };\n\n  const hasConversation = !!conversationId;\n\n  return (\n    <div className=\"chat-main\">\n      <div ref={listRef} className=\"messages-list\">\n        {messages.map((m) => (\n          <div key={m.id} className={`message ${m.isUser ? \"user-message\" : \"ai-message\"}`}>\n            <div className=\"message-avatar\"><span>{m.isUser ? \"U\" : \"AI\"}</span></div>\n            <div className=\"message-content\">\n              <div className=\"message-bubble\">\n                {m.isUser && m.corrections?.length > 0 ? (\n                  <div className=\"highlighted-text\">\n                    {renderTextWithHighlights(m, handleWordClick)}\n                  </div>\n                ) : (\n                  <span>{m.text}</span>\n                )}\n              </div>\n              <div className=\"message-timestamp\">{m.timestamp}</div>\n            </div>\n          </div>\n        ))}\n\n        {isTyping && (\n          <div className=\"message ai-message\">\n            <div className=\"message-avatar\"><span>AI</span></div>\n            <div className=\"message-content\">\n              <div className=\"message-bubble\">Typingâ€¦</div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {popover && (\n        <div className=\"grammar-popover\" style={{ top: popover.y, left: popover.x }}>\n          <div className=\"popover-header\">{popover.corr.label}</div>\n          <div className=\"popover-body\">{popover.corr.reason}</div>\n          <div className=\"popover-suggest\">\n            ðŸ‘‰ <b>{popover.corr.suggestion}</b>\n          </div>\n          <button onClick={() => applyCorrection(popover.msgId, popover.corr)}>Apply</button>\n          <button onClick={() => setPopover(null)}>Close</button>\n        </div>\n      )}\n\n      <form className=\"chat-input-form\" onSubmit={handleSend}>\n        <div className=\"input-container\">\n          <input\n            className=\"message-input\"\n            type=\"text\"\n            placeholder={\n              hasConversation\n                ? \"Type your message...\"\n                : \"Please select or start a new conversation\"\n            }\n            value={text}\n            onChange={(e) => setText(e.target.value)}\n          />\n          <button className=\"send-btn\" type=\"submit\" disabled={!text.trim()}>\n            <svg\n              width=\"16\"\n              height=\"16\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            >\n              <path d=\"m22 2-7 20-4-9-9-4Z\" />\n              <path d=\"M22 2 11 13\" />\n            </svg>\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n\nfunction renderTextWithHighlights(msg, onClick) {\n  let text = msg.text;\n\n  msg.corrections.forEach((corr) => {\n    const regex = new RegExp(`(${escapeRegex(corr.original)})`, \"gi\");\n    text = text.replace(\n      regex,\n      `<span class=\"${corr.applied ? \"word-fixed\" : \"word-error\"\n      }\" data-id=\"${corr.id}\">$1</span>`\n    );\n  });\n\n  return (\n    <span\n      dangerouslySetInnerHTML={{ __html: text }}\n      onClick={(e) => {\n        const span = e.target.closest(\"span[data-id]\");\n        if (!span) return;\n        const id = parseInt(span.getAttribute(\"data-id\"));\n        const corr = msg.corrections.find((c) => c.id === id);\n        if (corr) onClick(e, msg.id, corr);\n      }}\n    />\n  );\n}\n\nfunction escapeRegex(str) {\n  return str.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
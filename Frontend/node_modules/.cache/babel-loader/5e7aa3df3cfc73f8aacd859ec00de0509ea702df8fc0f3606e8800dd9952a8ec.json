{"ast":null,"code":"var _jsxFileName = \"F:\\\\english-chat\\\\Frontend\\\\src\\\\components\\\\ChatMain.js\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport \"../styles/ChatMessage.css\";\nimport \"../styles/ChatInput.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ChatMain() {\n  _s();\n  const {\n    id\n  } = useParams();\n  const [text, setText] = useState(\"\");\n  const [isTyping, setIsTyping] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [popover, setPopover] = useState(null);\n  const listRef = useRef(null);\n\n  // Tá»± Ä‘á»™ng cuá»™n xuá»‘ng cuá»‘i khi cÃ³ tin nháº¯n má»›i\n  useEffect(() => {\n    var _listRef$current;\n    (_listRef$current = listRef.current) === null || _listRef$current === void 0 ? void 0 : _listRef$current.scrollTo({\n      top: listRef.current.scrollHeight,\n      behavior: \"smooth\"\n    });\n  }, [messages, id]);\n\n  // ====================== Gá»¬I TIN NHáº®N ======================\n  const handleSend = async e => {\n    e.preventDefault();\n    const userText = text.trim();\n    if (!userText) return;\n    const now = new Date().toLocaleTimeString([], {\n      hour: \"2-digit\",\n      minute: \"2-digit\"\n    });\n    const msgId = Date.now();\n\n    // ThÃªm user message\n    const newMsg = {\n      id: msgId,\n      text: userText,\n      isUser: true,\n      timestamp: now,\n      corrections: []\n    };\n    setMessages(prev => [...prev, newMsg]);\n    setText(\"\");\n    setIsTyping(true);\n    try {\n      const [chatRes, grammarRes] = await Promise.all([fetch(\"http://localhost:3030/api/chat\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          text: userText\n        })\n      }), fetch(\"http://localhost:3030/api/grammar\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          text: userText\n        })\n      })]);\n      const chatData = await chatRes.json();\n      const grammarData = await grammarRes.json();\n\n      // Gáº¯n lá»—i ngá»¯ phÃ¡p vÃ o message user\n      setMessages(prev => prev.map(m => {\n        var _grammarData$correcti;\n        return m.id === msgId ? {\n          ...m,\n          corrections: ((_grammarData$correcti = grammarData.corrections) === null || _grammarData$correcti === void 0 ? void 0 : _grammarData$correcti.map((c, i) => ({\n            id: i + 1,\n            original: c.original,\n            suggestion: c.suggestion,\n            reason: c.reason,\n            label: c.label,\n            applied: false\n          }))) || []\n        } : m;\n      }));\n\n      // Pháº£n há»“i cá»§a AI\n      setMessages(prev => [...prev, {\n        id: msgId + 1,\n        text: chatData.reply || \"Okay!\",\n        isUser: false,\n        timestamp: new Date().toLocaleTimeString([], {\n          hour: \"2-digit\",\n          minute: \"2-digit\"\n        })\n      }]);\n    } catch (err) {\n      console.error(\"Error contacting API:\", err);\n      setMessages(prev => [...prev, {\n        id: msgId + 1,\n        text: \"Demo pháº£n há»“i cá»§a AI\",\n        isUser: false,\n        timestamp: new Date().toLocaleTimeString([], {\n          hour: \"2-digit\",\n          minute: \"2-digit\"\n        })\n      }]);\n    } finally {\n      setIsTyping(false);\n    }\n  };\n  const applyCorrection = (msgId, corr) => {\n    setMessages(prev => prev.map(m => {\n      if (m.id !== msgId) return m;\n      const regex = new RegExp(`\\\\b${escapeRegex(corr.original)}\\\\b`, \"i\");\n      const newText = m.text.replace(regex, corr.suggestion);\n      const updatedCorrections = m.corrections.map(c => c.id === corr.id ? {\n        ...c,\n        applied: true\n      } : c);\n      return {\n        ...m,\n        text: newText,\n        corrections: updatedCorrections\n      };\n    }));\n    setPopover(null);\n  };\n  const handleWordClick = (e, msgId, corr) => {\n    const rect = e.target.getBoundingClientRect();\n    const popoverWidth = 260;\n    const popoverHeight = 140;\n    let x = rect.left;\n    let y = rect.bottom + window.scrollY;\n    if (x + popoverWidth > window.innerWidth - 20) x = window.innerWidth - popoverWidth - 20;\n    if (y + popoverHeight > window.innerHeight + window.scrollY) y = rect.top + window.scrollY - popoverHeight - 10;\n    setPopover({\n      x,\n      y,\n      corr,\n      msgId\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-main\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: listRef,\n      className: \"messages-list\",\n      children: [messages.map(m => {\n        var _m$corrections;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `message ${m.isUser ? \"user-message\" : \"ai-message\"}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-avatar\",\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              children: m.isUser ? \"U\" : \"AI\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 45\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-bubble\",\n              children: m.isUser && ((_m$corrections = m.corrections) === null || _m$corrections === void 0 ? void 0 : _m$corrections.length) > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"highlighted-text\",\n                children: renderTextWithHighlights(m, handleWordClick)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                children: m.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-timestamp\",\n              children: m.timestamp\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 13\n          }, this)]\n        }, m.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }, this);\n      }), isTyping && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"message ai-message\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message-avatar\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"AI\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 45\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message-content\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-bubble\",\n            children: \"Typing\\u2026\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, this), popover && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grammar-popover\",\n      style: {\n        top: popover.y,\n        left: popover.x\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"popover-header\",\n        children: popover.corr.label\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"popover-body\",\n        children: popover.corr.reason\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"popover-suggest\",\n        children: [\"\\uD83D\\uDC49 \", /*#__PURE__*/_jsxDEV(\"b\", {\n          children: popover.corr.suggestion\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 16\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => applyCorrection(popover.msgId, popover.corr),\n        children: \"Apply\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setPopover(null),\n        children: \"Close\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"chat-input-form\",\n      onSubmit: handleSend,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"message-input\",\n          type: \"text\",\n          placeholder: \"Type your message...\",\n          value: text,\n          onChange: e => setText(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"send-btn\",\n          type: \"submit\",\n          disabled: !text.trim(),\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            width: \"16\",\n            height: \"16\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            strokeWidth: \"2\",\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            children: [/*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"m22 2-7 20-4-9-9-4Z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M22 2 11 13\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 143,\n    columnNumber: 5\n  }, this);\n}\n\n// ====================== Gáº CH CHÃ‚N & CLICK ======================\n_s(ChatMain, \"FtwSl7QPGIjQlvVT+KManrXc3b4=\", false, function () {\n  return [useParams];\n});\n_c = ChatMain;\nfunction renderTextWithHighlights(msg, onClick) {\n  let text = msg.text;\n\n  // Duyá»‡t tá»«ng lá»—i vÃ  chÃ¨n highlight vÃ o text\n  msg.corrections.forEach(corr => {\n    const regex = new RegExp(`(${escapeRegex(corr.original)})`, \"gi\");\n    text = text.replace(regex, `<span class=\"${corr.applied ? \"word-fixed\" : \"word-error\"}\" data-id=\"${corr.id}\">$1</span>`);\n  });\n  return /*#__PURE__*/_jsxDEV(\"span\", {\n    dangerouslySetInnerHTML: {\n      __html: text\n    },\n    onClick: e => {\n      const span = e.target.closest(\"span[data-id]\");\n      if (!span) return;\n      const id = parseInt(span.getAttribute(\"data-id\"));\n      const corr = msg.corrections.find(c => c.id === id);\n      if (corr) onClick(e, msg.id, corr);\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 231,\n    columnNumber: 5\n  }, this);\n}\n\n// ====================== ESCAPE REGEX ======================\nfunction escapeRegex(str) {\n  return str.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\nvar _c;\n$RefreshReg$(_c, \"ChatMain\");","map":{"version":3,"names":["useState","useRef","useEffect","useParams","jsxDEV","_jsxDEV","ChatMain","_s","id","text","setText","isTyping","setIsTyping","messages","setMessages","popover","setPopover","listRef","_listRef$current","current","scrollTo","top","scrollHeight","behavior","handleSend","e","preventDefault","userText","trim","now","Date","toLocaleTimeString","hour","minute","msgId","newMsg","isUser","timestamp","corrections","prev","chatRes","grammarRes","Promise","all","fetch","method","headers","body","JSON","stringify","chatData","json","grammarData","map","m","_grammarData$correcti","c","i","original","suggestion","reason","label","applied","reply","err","console","error","applyCorrection","corr","regex","RegExp","escapeRegex","newText","replace","updatedCorrections","handleWordClick","rect","target","getBoundingClientRect","popoverWidth","popoverHeight","x","left","y","bottom","window","scrollY","innerWidth","innerHeight","className","children","ref","_m$corrections","fileName","_jsxFileName","lineNumber","columnNumber","length","renderTextWithHighlights","style","onClick","onSubmit","type","placeholder","value","onChange","disabled","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","_c","msg","forEach","dangerouslySetInnerHTML","__html","span","closest","parseInt","getAttribute","find","str","$RefreshReg$"],"sources":["F:/english-chat/Frontend/src/components/ChatMain.js"],"sourcesContent":["import { useState, useRef, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport \"../styles/ChatMessage.css\";\nimport \"../styles/ChatInput.css\";\n\nexport default function ChatMain() {\n  const { id } = useParams();\n  const [text, setText] = useState(\"\");\n  const [isTyping, setIsTyping] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [popover, setPopover] = useState(null);\n  const listRef = useRef(null);\n\n  // Tá»± Ä‘á»™ng cuá»™n xuá»‘ng cuá»‘i khi cÃ³ tin nháº¯n má»›i\n  useEffect(() => {\n    listRef.current?.scrollTo({ top: listRef.current.scrollHeight, behavior: \"smooth\" });\n  }, [messages, id]);\n\n  // ====================== Gá»¬I TIN NHáº®N ======================\n  const handleSend = async (e) => {\n    e.preventDefault();\n    const userText = text.trim();\n    if (!userText) return;\n\n    const now = new Date().toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" });\n    const msgId = Date.now();\n\n    // ThÃªm user message\n    const newMsg = {\n      id: msgId,\n      text: userText,\n      isUser: true,\n      timestamp: now,\n      corrections: [],\n    };\n    setMessages((prev) => [...prev, newMsg]);\n    setText(\"\");\n    setIsTyping(true);\n\n    try {\n      const [chatRes, grammarRes] = await Promise.all([\n        fetch(\"http://localhost:3030/api/chat\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ text: userText }),\n        }),\n        fetch(\"http://localhost:3030/api/grammar\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ text: userText }),\n        }),\n      ]);\n\n      const chatData = await chatRes.json();\n      const grammarData = await grammarRes.json();\n\n      // Gáº¯n lá»—i ngá»¯ phÃ¡p vÃ o message user\n      setMessages((prev) =>\n        prev.map((m) =>\n          m.id === msgId\n            ? {\n              ...m,\n              corrections:\n                grammarData.corrections?.map((c, i) => ({\n                  id: i + 1,\n                  original: c.original,\n                  suggestion: c.suggestion,\n                  reason: c.reason,\n                  label: c.label,\n                  applied: false,\n                })) || [],\n            }\n            : m\n        )\n      );\n\n      // Pháº£n há»“i cá»§a AI\n      setMessages((prev) => [\n        ...prev,\n        {\n          id: msgId + 1,\n          text: chatData.reply || \"Okay!\",\n          isUser: false,\n          timestamp: new Date().toLocaleTimeString([], {\n            hour: \"2-digit\",\n            minute: \"2-digit\",\n          }),\n        },\n      ]);\n    } catch (err) {\n      console.error(\"Error contacting API:\", err);\n      setMessages((prev) => [\n        ...prev,\n        {\n          id: msgId + 1,\n          text: \"Demo pháº£n há»“i cá»§a AI\",\n          isUser: false,\n          timestamp: new Date().toLocaleTimeString([], {\n            hour: \"2-digit\",\n            minute: \"2-digit\",\n          }),\n        },\n      ]);\n    } finally {\n      setIsTyping(false);\n    }\n  };\n\n  const applyCorrection = (msgId, corr) => {\n    setMessages((prev) =>\n      prev.map((m) => {\n        if (m.id !== msgId) return m;\n\n        const regex = new RegExp(`\\\\b${escapeRegex(corr.original)}\\\\b`, \"i\");\n        const newText = m.text.replace(regex, corr.suggestion);\n\n        const updatedCorrections = m.corrections.map((c) =>\n          c.id === corr.id ? { ...c, applied: true } : c\n        );\n\n        return { ...m, text: newText, corrections: updatedCorrections };\n      })\n    );\n    setPopover(null);\n  };\n\n  const handleWordClick = (e, msgId, corr) => {\n    const rect = e.target.getBoundingClientRect();\n    const popoverWidth = 260;\n    const popoverHeight = 140;\n    let x = rect.left;\n    let y = rect.bottom + window.scrollY;\n\n    if (x + popoverWidth > window.innerWidth - 20)\n      x = window.innerWidth - popoverWidth - 20;\n    if (y + popoverHeight > window.innerHeight + window.scrollY)\n      y = rect.top + window.scrollY - popoverHeight - 10;\n\n    setPopover({ x, y, corr, msgId });\n  };\n\n  return (\n    <div className=\"chat-main\">\n      <div ref={listRef} className=\"messages-list\">\n        {messages.map((m) => (\n          <div key={m.id} className={`message ${m.isUser ? \"user-message\" : \"ai-message\"}`}>\n            <div className=\"message-avatar\"><span>{m.isUser ? \"U\" : \"AI\"}</span></div>\n            <div className=\"message-content\">\n              <div className=\"message-bubble\">\n                {m.isUser && m.corrections?.length > 0 ? (\n                  <div className=\"highlighted-text\">\n                    {renderTextWithHighlights(m, handleWordClick)}\n                  </div>\n                ) : (\n                  <span>{m.text}</span>\n                )}\n              </div>\n              <div className=\"message-timestamp\">{m.timestamp}</div>\n            </div>\n          </div>\n        ))}\n\n        {isTyping && (\n          <div className=\"message ai-message\">\n            <div className=\"message-avatar\"><span>AI</span></div>\n            <div className=\"message-content\">\n              <div className=\"message-bubble\">Typingâ€¦</div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {popover && (\n        <div className=\"grammar-popover\" style={{ top: popover.y, left: popover.x }}>\n          <div className=\"popover-header\">{popover.corr.label}</div>\n          <div className=\"popover-body\">{popover.corr.reason}</div>\n          <div className=\"popover-suggest\">\n            ðŸ‘‰ <b>{popover.corr.suggestion}</b>\n          </div>\n          <button onClick={() => applyCorrection(popover.msgId, popover.corr)}>Apply</button>\n          <button onClick={() => setPopover(null)}>Close</button>\n        </div>\n      )}\n\n      {/* Form nháº­p */}\n      <form className=\"chat-input-form\" onSubmit={handleSend}>\n        <div className=\"input-container\">\n          <input\n            className=\"message-input\"\n            type=\"text\"\n            placeholder=\"Type your message...\"\n            value={text}\n            onChange={(e) => setText(e.target.value)}\n          />\n          <button className=\"send-btn\" type=\"submit\" disabled={!text.trim()}>\n            <svg\n              width=\"16\"\n              height=\"16\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            >\n              <path d=\"m22 2-7 20-4-9-9-4Z\" />\n              <path d=\"M22 2 11 13\" />\n            </svg>\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n\n// ====================== Gáº CH CHÃ‚N & CLICK ======================\nfunction renderTextWithHighlights(msg, onClick) {\n  let text = msg.text;\n\n  // Duyá»‡t tá»«ng lá»—i vÃ  chÃ¨n highlight vÃ o text\n  msg.corrections.forEach((corr) => {\n    const regex = new RegExp(`(${escapeRegex(corr.original)})`, \"gi\");\n    text = text.replace(\n      regex,\n      `<span class=\"${corr.applied ? \"word-fixed\" : \"word-error\"\n      }\" data-id=\"${corr.id}\">$1</span>`\n    );\n  });\n\n  return (\n    <span\n      dangerouslySetInnerHTML={{ __html: text }}\n      onClick={(e) => {\n        const span = e.target.closest(\"span[data-id]\");\n        if (!span) return;\n        const id = parseInt(span.getAttribute(\"data-id\"));\n        const corr = msg.corrections.find((c) => c.id === id);\n        if (corr) onClick(e, msg.id, corr);\n      }}\n    />\n  );\n}\n\n// ====================== ESCAPE REGEX ======================\nfunction escapeRegex(str) {\n  return str.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}